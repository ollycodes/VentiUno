{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="{% static 'game/style.css' %}">
    <link 
        rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
        />
    <meta charset="utf-8">
    <meta name="description" content="A simple game of blackjack.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Blackjack</title>
</head>

<body>
    <div class="wrapper">
        <h1>Blackjack</h1>
        <h2> Dealer's hand</h2>
        {% if game.action == "stand" or game.player_total >= 21 %}
            <div class="hand">
                    <div>
                        <img class="card" 
                        src="{% static 'game/svgs/fronts/' %}{{ game.dealer_hand.0.file_name }}" 
                        alt="{{ game.dealer_hand.0.name }}">
                    </div>
                    <div>
                        <img class="card card_flip" 
                        src="{% static 'game/svgs/fronts/' %}{{ game.dealer_hand.1.file_name }}" 
                        alt="{{ game.dealer_hand.1.name }}">
                    </div>
                    {% for card in game.dealer_hand|slice:"2:" %}
                    <div>
                        <img class="card card_draw" 
                        src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" 
                        alt="{{ card.name }}">
                    </div>
                    {% endfor %}
            </div>
            
            {% else %}
                <div class="hand">
                    <div>
                        <img class="card" 
                        src="{% static 'game/svgs/fronts/' %}{{game.dealer_hand.0.file_name}}" 
                        alt="{{ game.dealer_hand.0.name }}">
                    </div>
                    <div>
                        <img class="card" src="{% static 'game/svgs/backs/abstract.svg' %}">
                    </div>
                </div>
            {% endif %}

    <h2> {{ table.player_name }}'s hand</h2>
            <div class="hand">
                {% if game.action == "stand" %}
                    {% for card in game.player_hand %}
                        <div>
                            <img class="card" 
                            src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" 
                            alt="{{ card.name }}">
                        </div>
                    {% endfor %}
                {% else %}
                    {% for card in game.player_hand|slice:":-1" %}
                        <div>
                            <img class="card" 
                            src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" 
                            alt="{{ card.name }}">
                        </div>
                    {% endfor %}

                    {% for card in game.player_hand|slice:"-1:" %}
                        <div>
                            <img class="card card_draw" 
                            src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" 
                            alt="{{ card.name }}">
                        </div>
                    {% endfor %}
                {% endif %}
            </div>

            {% if game.action == "stand" or game.player_total >= 21 %}
                <p class="{{ game.winner }}">{{ game.winner }}!</p>

                <div class="button-box">
                    <form class="game-action-form" 
                        action="{% url 'bj:play_again' table.id %}" method="post">
                        {% csrf_token %}
                        
                        <input type="text" name="player_name" 
                        value="play_again" hidden>
                        
                        <input class="game-action-button" 
                        type="submit" value="Play again">
                    </form>
                </div>
            {% else %}
                <div class="button-box">
                    <form class="game-action-form" 
                        action="{% url 'bj:hit' table.id %}" 
                        method="post">

                        {% csrf_token %}
                        <input class="game-action-button" 
                        type="submit" id="hit" value="hit">

                    </form>

                    <form class="game-action-form" 
                        action="{% url 'bj:stand' table.id %}" 
                        method="post">

                        {% csrf_token %}
                        <input class="game-action-button" 
                        type="submit" id="stand" value="stand">

                    </form>
                </div>
            {% endif %}
    </div>
</body>
</html>
