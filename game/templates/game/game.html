{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="stylesheet" type="text/css" href="{% static 'game/style.css' %}">
    <link 
        rel="stylesheet" 
        href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
        />
    <meta charset="utf-8">
    <meta name="description" content="A simple game of blackjack.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Blackjack</title>
</head>

<body>
    <div class="wrapper">
    <h1>Blackjack</h1>
    <h2> Dealer's hand</h2>
            {% if game.is_finished %}
            <div class="hand">
                    {% for card in table.dealer_hand %}
                    <div>
                        <img class="card" src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" alt="{{ card.name }}">
                    </div>
                    {% endfor %}
            </div>
                <p>Dealer's total: {{ game.dealer_total }}</p>
            
            {% else %}
            <div class="hand">
                <div>
                    <img class="card" src="{% static 'game/svgs/fronts/' %}{{game.dealer_hand.0.file_name}}" alt="{{ game.dealer_hand.0.name }}">
                </div>
                <img class="card" src="{% static 'game/svgs/backs/abstract.svg' %}">
            </div>


            {% endif %}

    <h2> {{ table.player_name }}'s hand</h2>
            <div class="hand">
                {% for card in table.player_hand %}
                    <div>
                        <img class="card animate__animated animate__flipInY" src="{% static 'game/svgs/fronts/' %}{{ card.file_name }}" alt="{{ card.name }}">
                    </div>
                {% endfor %}
            </div>
            <p>player total: {{ game.player_total }}</p>

    {% if game.is_finished %}
        {% if game.winner == "player won" %}
            <p class="outcome win">{{ table.player_name }} won!</p>
        {% elif game.winner == "Dealer won!" %}
            <p class="outcome lose">{{ game.winner }}</p>
        {% else %}
            <p class="outcome">{{ game.winner }}</p>
        {% endif %}

        <div class="button-box">
            <form class="game-action-form" action="{% url 'bj:setup' %}" method="post">
            {% csrf_token %}
                <input type="text" name="player_name" value="{{ table.player_name }}" hidden>
                <input class="game-action-button" type="submit" value="Play again">
            </form>
        </div>

    {% else %}
        <div class="button-box">
            <form class="game-action-form" action="{% url 'bj:hit' table.id %}" method="post">
            {% csrf_token %}
                <input class="game-action-button" type="submit" id="hit" value="hit">
                </form>

            <form class="game-action-form" action="{% url 'bj:stand' table.id %}" method="post">
            {% csrf_token %}
                <input class="game-action-button" type="submit" id="stand" value="stand">
            </form>
        </div>
    {% endif %}
    </div>
</body>
</html>
